%% State Space System

% Copyrights of AlphaLink Engineering GmbH - 
% The source must always be stated in publications

%% Trim values

% Airspeed:             17 m/s
% Flight path angle:    0°
% Elevator deflection:  -7.86°
% Thrust lever:         0.9062
% Angle of attack:      1.6801

%% System matrices

% State matrix
A = [-3.20184347825593,-263.201927689533,-4.41495196394279e-16,0,...
     0.0650938556690633,0,-0.0190955549281219,0;0.928914020486476...
     ,-10.1345081714351,-0.0661549315901852,2.40646044757931e-12,...
     0.00152489013071075,0.193211554556880,-0.000153311603734335,0;...
     -0.0368987035377027,4.54724199247373,-0.991142719920148,...
     -9.80649999983529,0.000791526954600857,0.100290603802303,...
     -7.95796761328621e-05,0;1.00000000000000,0,0,0,0,0,0,0;...
     0,-8.05482929320302e-33,-1.30790198798184e-16,0,...
     -0.998104700904939,34.4737040915347,-0.340387978587240,0;...
     0,-1.19531076226110e-34,3.37613337394000e-18,0,-0.985752943603848,...
     -1.24604057805388,0.0266940474352643,0.576604951392651;...
     0,1.03413756701762e-31,1.05300552846359e-15,0,-0.619747583430176,...
     -89.5432085884003,-12.3008974416625,0;0,0,0,0,0.0293318456939211,...
     0,1.00000000000000,0];
 
% Input matrix
B = [-118.876920345629,0,0,-4.38948080385834e-11,3.52393830009948e-16,...
     0,15.4824663346106,0.0190955549281219,3.20184347825593,...
     -0.0650938556690633;-0.919796925578148,-0.0320801903331470,0,...
     3.53366406021298e-12,0.0661549315994322,-0.0113653855621681,...
     0.596147539493572,0.000153311603734335,0.0710859795121870,...
     -0.00152489013071075;-0.353801622973885,18.5928714234395,0,...
     -1.13537320444642e-21,0.991142720058688,-0.00589944728248770,...
     -0.267484823085519,7.95796761328621e-05,0.0368987032067898,...
     -0.000791526954600857;0,0,0,0,0,0,0,0,0,0;-1.33124595927319e-11,...
     0,-2.88633849549145,-37.5963029628415,1.30790198816466e-16,...
     -2.02786494656063,0,0.340387978587240,0,0.998104700904939;0,0,...
     0.0512552598398088,0.488632227913903,-3.37613337441191e-18,...
     0.0732965045913962,0,0.00262518846286384,0,-0.0138171551916883;...
     -2.43569190258914e-13,0,-317.273395287981,44.9031590970898,...
     -1.05300552861078e-15,5.26724756402294,0,12.3008974416625,0,...
     0.619747583430176;0,0,0,0,0,0,0,0,0,0];
 
% Output matrix 
C = [1,0,0,0,0,0,0,0;0,1,1.49071720966096e-19,0,0,0,0,0;0,...
     3.92634798071491e-18,1,0,0,0,0,0;0,0,0,1,0,0,0,0;0,0,0,0,1,0,0,0;...
     0,0,0,0,0,1,0,0;0,0,0,0,0,0,1,0;0,0,0,0,0,0,0,1;0,...
     -0.999999999999278,-1.44227382584314e-15,1.00000000000006,0,0,0,0;...
     0,3.92634798071491e-18,1,0,0,0,0,0;0,-2.71629516111256e-33,...
     5.73942673569866e-17,0,-16.7578000412674,-21.1826898269184,...
     0.453798806399546,9.80228417367619];

% Feedforward matrix 
D = [0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,-0.0588235294115072,0,0,0;0,0,0,...
     0,-1.00000000013978,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,...
     0,0,0;0,0,0,0,0,-0.0588235294117579,0,0,0,0;0,0,0,0,0,0,0,0,0,0;...
     0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;...
     0,0,0.871339417276850,8.30674787453731,-5.73942673650091e-17,...
     1.24604057805388,0,0.0446282038686905,0,-0.234891638258729];
 
%% State space description

% State names
StateNames = {'\delta q';'\delta \alpha';'\delta V_A';'\delta \Theta';...
              '\delta r';'\delta \beta';'\delta p';'\delta \Phi'};
 
% Input names
InputNames = {'\delta \eta';'\delta TL';'\delta \xi';'\delta \zeta';...
              '\delta u_{wg}';'\delta v_{wg}';'\delta w_{wg}';...
              '\delta p_{wf}';'\delta q_{wf}';'\delta r_{wf}'};

% Output names
OutputNames = {'\delta q';'\delta \alpha';'\delta V_A';'\delta \Theta';...
               '\delta r';'\delta \beta';'\delta p';'\delta \Phi';...
               '\delta \gamma';'\delta GS';'\delta b_y'};

%% State Space System

G = ss(A,B,C,D,'InputName',InputNames,'StateName',StateNames,...
      'OutputName',OutputNames);
  